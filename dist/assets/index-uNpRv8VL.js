(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const u of r.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function a(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(n){if(n.ep)return;n.ep=!0;const r=a(n);fetch(n.href,r)}})();async function L(){const e=document.querySelector("header"),t=document.querySelector("footer");if(e){const s=await fetch("partials/header.html");e.innerHTML=await s.text()}if(t){const s=await fetch("partials/footer.html");t.innerHTML=await s.text()}const a=document.getElementById("year");a&&(a.textContent=new Date().getFullYear());const o=document.getElementById("themeToggle"),n=localStorage.getItem("levelup-pref-theme")||"dark";if(document.documentElement.setAttribute("data-theme",n),o){let s=function(i){const c=document.documentElement;c.classList.add("theming"),c.setAttribute("data-theme",i),localStorage.setItem("levelup-pref-theme",i),o.textContent=i==="dark"?"üåô":"‚òÄÔ∏è",clearTimeout(window.__themeTimer),window.__themeTimer=setTimeout(()=>{c.classList.remove("theming")},450)};var u=s;o.textContent=n==="dark"?"üåô":"‚òÄÔ∏è",o.addEventListener("click",()=>{const c=document.documentElement.getAttribute("data-theme")==="dark"?"light":"dark";s(c)})}const r=location.pathname.split("/").pop()||"index.html";document.querySelectorAll("nav a").forEach(s=>{(s.getAttribute("href")||"").split("/").pop()===r&&s.classList.add("active")})}const f=(e,t=document)=>t.querySelector(e);function v(e,t){typeof e=="string"&&(e=f(e)),e.innerHTML=t}function y(e,t){typeof e=="string"&&(e=f(e)),e.insertAdjacentHTML("beforeend",t)}function h(e){return(e||"").toString().replace(/[&<>"']/g,t=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"})[t])}const b="cab8a530d1b74e168df21c53d34e0cf8",w="https://api.rawg.io/api";function S(e){const t=new URLSearchParams({key:b});return Object.entries(e||{}).forEach(([a,o])=>{o!=null&&o!==""&&t.set(a,o)}),t.toString()}function _(e={}){const t={ordering:e.ordering||"-added",page_size:e.page_size||24};return e.search&&(t.search=e.search,t.search_precise=!0,e.search_exact&&(t.search_exact=!0)),e.genres&&(t.genres=e.genres),e.platforms&&(t.platforms=e.platforms),e.dates&&(t.dates=e.dates),e.metacritic&&(t.metacritic=e.metacritic),t}async function A(e={}){const t=`${w}/games?${S(_(e))}`,a=await fetch(t);if(!a.ok)throw new Error("RAWG games error");return a.json()}function $(e){const t=e.background_image||"public/favicon.svg",a=(e.parent_platforms||[]).map(o=>o.platform.name).slice(0,3).join(" ‚Ä¢ ");return`
    <a href="detail.html?id=${e.id}" class="card-link">
      <article class="slide card" role="listitem">
        <img src="${t}" alt="${h(e.name)} cover" loading="lazy" />
        <div class="meta">
          <div class="title">${h(e.name)}</div>
          <div class="sub">${h(e.released||"N/A")} ‚Ä¢ ‚≠ê ${e.rating} ‚Ä¢ ${h(a||"Platforms N/A")}</div>
        </div>
      </article>
    </a>
  `}async function x(){const e=f("#carouselTrack"),t=f("#carouselDots"),a=f("#prevSlide"),o=f("#nextSlide");let n=[];try{n=((await A({ordering:"-rating",page_size:12})).results||[]).slice(0,6)}catch{v(e,'<div class="error"><p>Could not load top games.</p></div>');return}if(!n.length){v(e,'<div class="empty"><p>No games found.</p></div>');return}n.forEach((l,d)=>{y(e,$(l)),y(t,`<button class="dot${d===0?" is-active":""}" data-idx="${d}" aria-label="Go to slide ${d+1}" role="tab"></button>`)});let r=0,u=null;const s=4500;function i(l){r=(l+n.length)%n.length,e.style.transform=`translateX(calc(${r} * -100%))`,t.querySelectorAll(".dot").forEach((d,E)=>d.classList.toggle("is-active",E===r))}function c(){g(),u=setInterval(()=>i(r+1),s)}function g(){u&&clearInterval(u),u=null}o.addEventListener("click",()=>{i(r+1),c()}),a.addEventListener("click",()=>{i(r-1),c()}),t.addEventListener("click",l=>{const d=l.target.closest(".dot");d&&(i(Number(d.dataset.idx)),c())});const m=e.parentElement;m.addEventListener("mouseenter",g),m.addEventListener("mouseleave",c),m.addEventListener("focusin",g),m.addEventListener("focusout",c);let p=null;m.addEventListener("touchstart",l=>p=l.touches[0].clientX,{passive:!0}),m.addEventListener("touchend",l=>{if(p==null)return;const d=l.changedTouches[0].clientX-p;Math.abs(d)>40&&(i(r+(d<0?1:-1)),c()),p=null}),i(0),c()}(async()=>(await L(),x()))();
