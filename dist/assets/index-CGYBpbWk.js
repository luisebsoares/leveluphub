(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const u of r.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function o(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(n){if(n.ep)return;n.ep=!0;const r=o(n);fetch(n.href,r)}})();async function L(){const e=document.querySelector("header"),t=document.querySelector("footer");if(e){const l=await fetch("partials/header.html");e.innerHTML=await l.text()}if(t){const l=await fetch("partials/footer.html");t.innerHTML=await l.text()}const o=document.getElementById("year");o&&(o.textContent=new Date().getFullYear());const a=document.getElementById("themeToggle"),n=localStorage.getItem("levelup-pref-theme")||"dark";if(document.documentElement.setAttribute("data-theme",n),a){let l=function(d){const c=document.documentElement;c.classList.add("theming"),c.setAttribute("data-theme",d),localStorage.setItem("levelup-pref-theme",d),a.textContent=d==="dark"?"üåô":"‚òÄÔ∏è",clearTimeout(window.__themeTimer),window.__themeTimer=setTimeout(()=>{c.classList.remove("theming")},450)};var u=l;a.textContent=n==="dark"?"üåô":"‚òÄÔ∏è",a.addEventListener("click",()=>{const c=document.documentElement.getAttribute("data-theme")==="dark"?"light":"dark";l(c)})}const r=location.pathname.split("/").pop()||"index.html";document.querySelectorAll("nav a").forEach(l=>{(l.getAttribute("href")||"").split("/").pop()===r&&l.classList.add("active")})}const m=(e,t=document)=>t.querySelector(e);function y(e,t){typeof e=="string"&&(e=m(e)),e.innerHTML=t}function E(e,t){typeof e=="string"&&(e=m(e)),e.insertAdjacentHTML("beforeend",t)}function h(e){return(e||"").toString().replace(/[&<>"']/g,t=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"})[t])}const b="cab8a530d1b74e168df21c53d34e0cf8",w="https://api.rawg.io/api";function S(e){const t=new URLSearchParams({key:b});return Object.entries(e||{}).forEach(([o,a])=>{a!=null&&a!==""&&t.set(o,a)}),t.toString()}function _(e={}){const t={ordering:e.ordering||"-added",page_size:e.page_size||24};return e.search&&(t.search=e.search,t.search_precise=!0,e.search_exact&&(t.search_exact=!0)),e.genres&&(t.genres=e.genres),e.platforms&&(t.platforms=e.platforms),e.dates&&(t.dates=e.dates),e.metacritic&&(t.metacritic=e.metacritic),t}async function A(e={}){const t=`${w}/games?${S(_(e))}`,o=await fetch(t);if(!o.ok)throw new Error("RAWG games error");return o.json()}function $(e){const t=e.background_image||"public/favicon.svg",o=(e.parent_platforms||[]).map(a=>a.platform.name).slice(0,3).join(" ‚Ä¢ ");return`
    <a href="detail.html?id=${e.id}" class="card-link">
      <article class="slide card" role="listitem">
        <img src="${t}" alt="${h(e.name)} cover" loading="lazy" />
        <div class="meta">
          <div class="title">${h(e.name)}</div>
          <div class="sub">${h(e.released||"N/A")} ‚Ä¢ ‚≠ê ${e.rating} ‚Ä¢ ${h(o||"Platforms N/A")}</div>
        </div>
      </article>
    </a>
  `}function x(e){for(let t=e.length-1;t>0;t--){const o=Math.floor(Math.random()*(t+1));[e[t],e[o]]=[e[o],e[t]]}return e}async function T(){const e=m("#carouselTrack"),t=m("#carouselDots"),o=m("#prevSlide"),a=m("#nextSlide");let n=[];try{const s=((await A({ordering:"-added",page_size:40})).results||[]).filter(v=>v.rating>=4);n=x(s).slice(0,6)}catch(i){console.error(i),y(e,'<div class="error"><p>Could not load games.</p></div>');return}if(!n.length){y(e,'<div class="empty"><p>No games found.</p></div>');return}n.forEach((i,s)=>{E(e,$(i)),E(t,`<button class="dot${s===0?" is-active":""}" data-idx="${s}" aria-label="Go to slide ${s+1}" role="tab"></button>`)});let r=0,u=null;const l=4500;function d(i){r=(i+n.length)%n.length,e.style.transform=`translateX(calc(${r} * -100%))`,t.querySelectorAll(".dot").forEach((s,v)=>s.classList.toggle("is-active",v===r))}function c(){g(),u=setInterval(()=>d(r+1),l)}function g(){u&&clearInterval(u),u=null}a.addEventListener("click",()=>{d(r+1),c()}),o.addEventListener("click",()=>{d(r-1),c()}),t.addEventListener("click",i=>{const s=i.target.closest(".dot");s&&(d(Number(s.dataset.idx)),c())});const f=e.parentElement;f.addEventListener("mouseenter",g),f.addEventListener("mouseleave",c),f.addEventListener("focusin",g),f.addEventListener("focusout",c);let p=null;f.addEventListener("touchstart",i=>p=i.touches[0].clientX,{passive:!0}),f.addEventListener("touchend",i=>{if(p==null)return;const s=i.changedTouches[0].clientX-p;Math.abs(s)>40&&(d(r+(s<0?1:-1)),c()),p=null}),d(0),c()}(async()=>(await L(),T()))();
