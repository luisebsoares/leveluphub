(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))t(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&t(s)}).observe(document,{childList:!0,subtree:!0});function o(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function t(a){if(a.ep)return;a.ep=!0;const i=o(a);fetch(a.href,i)}})();async function F(){const e=document.querySelector("header"),r=document.querySelector("footer");if(e){const s=await fetch("/partials/header.html");e.innerHTML=await s.text()}if(r){const s=await fetch("/partials/footer.html");r.innerHTML=await s.text()}const o=document.getElementById("year");o&&(o.textContent=new Date().getFullYear());const t=document.getElementById("themeToggle"),a=localStorage.getItem("levelup-pref-theme")||"dark";document.documentElement.setAttribute("data-theme",a),t&&(t.textContent=a==="dark"?"üåô":"‚òÄÔ∏è",t.addEventListener("click",()=>{const d=document.documentElement.getAttribute("data-theme")==="dark"?"light":"dark";document.documentElement.setAttribute("data-theme",d),localStorage.setItem("levelup-pref-theme",d),t.textContent=d==="dark"?"üåô":"‚òÄÔ∏è"}));const i=location.pathname;document.querySelectorAll("nav a").forEach(s=>{s.getAttribute("href")===i&&s.classList.add("active")})}const c=(e,r=document)=>r.querySelector(e);function m(e,r){typeof e=="string"&&(e=c(e)),e.innerHTML=r}function p(e,r){typeof e=="string"&&(e=c(e)),e.insertAdjacentHTML("beforeend",r)}function P(e){m(e,'<div class="spinner" role="status" aria-label="Loading"></div>')}const y="https://api.rawg.io/api",x="cab8a530d1b74e168df21c53d34e0cf8";function b(e){const r=new URLSearchParams({key:x});return Object.entries(e||{}).forEach(([o,t])=>{t!=null&&t!==""&&r.set(o,t)}),r.toString()}function k(e={}){const r={ordering:e.ordering||"-added",page_size:e.page_size||24};return e.search&&(r.search=e.search),e.genres&&(r.genres=e.genres),e.platforms&&(r.platforms=e.platforms),e.dates&&(r.dates=e.dates),e.metacritic&&(r.metacritic=e.metacritic),r}async function N(e={}){const r=`${y}/games?${b(k(e))}`,o=await fetch(r);if(!o.ok)throw new Error("RAWG games error");return o.json()}async function O(){const e=await fetch(`${y}/genres?${b({})}`);if(!e.ok)throw new Error("RAWG genres error");return(await e.json()).results||[]}async function I(){const e=await fetch(`${y}/platforms?${b({page_size:50})}`);if(!e.ok)throw new Error("RAWG platforms error");return(await e.json()).results||[]}const S="levelup-favorites";function L(){try{return JSON.parse(localStorage.getItem(S)||"[]")}catch{return[]}}function R(e){localStorage.setItem(S,JSON.stringify(e))}function T(e){const r=L(),t=r.find(a=>a.id===e.id)?r.filter(a=>a.id!==e.id):[...r,e];return R(t),t}function j(e){return L().some(r=>r.id===e)}function _(e){const r=e.background_image||"/favicon.svg",o=(e.parent_platforms||[]).map(a=>a.platform.name).slice(0,3).join(" ‚Ä¢ "),t=j(e.id);return`<article class="card">
      <img src="${r}" alt="${e.name} cover" loading="lazy" />
      <div class="meta">
        <div class="title">${e.name}</div>
        <div class="sub">${e.released||"N/A"} ‚Ä¢ ‚≠ê ${e.rating} ‚Ä¢ ${o||"Platforms N/A"}</div>
      </div>
      <div class="card-actions">
        <a class="button" href="/detail.html?id=${e.id}">Details</a>
        <button class="button-ghost" data-fav="${e.id}">${t?"‚òÖ Remove":"‚òÜ Favorite"}</button>
      </div>
    </article>`}function $(e){return`<div class="empty"><p>${e}</p></div>`}function C(e){return`<div class="error"><p>${e}</p></div>`}function G(){return new URLSearchParams(location.search)}function E(e){const o=new URLSearchParams(e).toString(),t=o?`${location.pathname}?${o}`:location.pathname;history.pushState(null,"",t),window.dispatchEvent(new Event("popstate"))}async function M(){const e=c("#view");m(e,`<section class="filters" id="filters">
      <input id="q" class="input" type="search" placeholder="Search games..." aria-label="Search games" />
      <select id="genre" class="select" aria-label="Filter by genre"><option value="">All genres</option></select>
      <select id="platform" class="select" aria-label="Filter by platform"><option value="">All platforms</option></select>
      <select id="year" class="select" aria-label="Filter by year"><option value="">Any year</option></select>
      <select id="rating" class="select" aria-label="Filter by rating">
        <option value="">Any rating</option><option value="90,100">90‚Äì100</option>
        <option value="80,89">80‚Äì89</option><option value="70,79">70‚Äì79</option>
      </select></section>
    <section id="results">${$("Use the filters or start typing to discover games.")}</section>`);const r=new Date().getFullYear(),o=c("#year");for(let n=r;n>=2e3;n--)p(o,`<option value="${n}">${n}</option>`);try{const[n,u]=await Promise.all([O(),I()]);n.forEach(l=>p("#genre",`<option value="${l.slug}">${l.name}</option>`)),u.forEach(l=>p("#platform",`<option value="${l.id}">${l.name}</option>`))}catch(n){console.warn(n)}const t={q:c("#q"),genre:c("#genre"),platform:c("#platform"),year:c("#year"),rating:c("#rating"),results:c("#results")};function a(){const n=G();t.q.value=n.get("search")||"",t.genre.value=n.get("genres")||"",t.platform.value=n.get("platforms")||"";const u=n.get("dates")||"";t.year.value=u.slice(0,4)||"",t.rating.value=n.get("metacritic")||""}function i(){const n={};return t.q.value.trim()&&(n.search=t.q.value.trim()),t.genre.value&&(n.genres=t.genre.value),t.platform.value&&(n.platforms=t.platform.value),t.year.value&&(n.dates=`${t.year.value}-01-01,${t.year.value}-12-31`),t.rating.value&&(n.metacritic=t.rating.value),n}async function s(){P(t.results);try{const u=(await N(i())).results||[];if(!u.length){m(t.results,$("No results found. Try adjusting filters."));return}m(t.results,'<div class="grid" id="grid"></div>');const l=c("#grid");u.forEach(g=>p(l,_(g))),l.addEventListener("click",g=>{const v=g.target.closest("button[data-fav]");if(!v)return;const w=Number(v.getAttribute("data-fav")),f=u.find(h=>h.id===w);if(!f)return;const A={id:f.id,name:f.name,background_image:f.background_image,rating:f.rating,released:f.released},q=T(A);v.textContent=q.some(h=>h.id===w)?"‚òÖ Remove":"‚òÜ Favorite"})}catch{m(t.results,C("Sorry‚Äîsomething went wrong loading games."))}}a(),s();let d;t.q.addEventListener("input",()=>{clearTimeout(d),d=setTimeout(()=>E(i()),300)}),[t.genre,t.platform,t.year,t.rating].forEach(n=>n.addEventListener("change",()=>E(i()))),window.addEventListener("popstate",()=>{a(),s()})}(async()=>(await F(),M()))();
